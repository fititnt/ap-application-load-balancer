---
# FILE: {{ role_path }}/defaults/main.yml

application_load_balancer_name: "AP Application Load Balancer"
application_load_balancer_hide_alb: yes
application_load_balancer_forcedebug: no

application_load_balancer_apps: []

# application_load_balancer_apps_: []

application_load_balancer_apps_serverblock_template: '{{ role_path }}/templates/openresty/nginx/conf/vhosts/static-site.conf.j2'

# Note: at this moment, only "file" implemented. But later "syslog" could be one option
application_load_balancer_logs_method: "file"

# TODO: considerar implementar logrotate (fititnt, 2019-07-28 23:00 BRT)
application_load_balancer_logs_path: "/var/log/application_load_balancer"

### NGinx (OpenResty) __________________________________________________________
application_load_balancer_nginxconf_template: "{{ role_path }}/templates/openresty/nginx/conf/nginx.conf.j2"

# If you use "{{ role_path }}/templates/openresty/nginx/conf/nginx.conf.j2"
# and not a very customized nginx.conf, you can customize with these variables

application_load_balancer_nginx_user: "www-data"

# See {{ role_path }}/templates/openresty/nginx/conf/nginx.conf.j2
application_load_balancer_nginx_maincontext_custom: |
  # FILE: /usr/local/openresty/nginx/conf/nginx.conf
  # NGINX CONTEXT: main (global)
  # Change-me with variable application_load_balancer_nginx

application_load_balancer_nginx_eventscontext_custom: |
  # FILE: /usr/local/openresty/nginx/conf/nginx.conf
  # NGINX CONTEXT: events
  # Change-me with variable application_load_balancer_nginx_eventscontext_custom

application_load_balancer_nginx_httpcontext_custom: |
  # FILE: /usr/local/openresty/nginx/conf/nginx.conf
  # NGINX CONTEXT: events
  # Change-me with variable application_load_balancer_nginx_eventscontext_custom
  

### vnStat _____________________________________________________________________
# @see https://humdi.net/vnstat/
# @see https://www.howtoforge.com/tutorial/vnstat-network-monitoring-ubuntu/



### Application Load Balancer - Internal Use ___________________________________
# If you are creating custom ALB Rules (e.g. OpenResty Server Blocks) you will
# need to consider these rules


application_load_balancer_apprule_automatichttps_httpsblock: |
  ## Automatic HTTPS / 443 port (DO NOT REMOVE) - Start
  # Fallback certificate
  ssl_certificate /etc/ssl/resty-auto-ssl-fallback.crt;
  ssl_certificate_key /etc/ssl/resty-auto-ssl-fallback.key;

  # Real certificate
  ssl_certificate_by_lua_block {
    auto_ssl:ssl_certificate()
  }

  #  Let's Encrypt acme-challenge
  location /.well-known/acme-challenge/ {
    content_by_lua_block {
      auto_ssl:challenge_server()
    }
  }
  ## Automatic HTTPS / 443 port (DO NOT REMOVE) - Start

application_load_balancer_apprule_automatichttp_httpsblock: |
  ## Automatic HTTPS / :80 port (DO NOT REMOVE) - Start
  #  Let's Encrypt acme-challenge
  location /.well-known/acme-challenge/ {
    content_by_lua_block {
      auto_ssl:challenge_server()
    }
  }
  ## Automatic HTTPS / :80 port (DO NOT REMOVE) - Start

### AP-ALB++ PHP _______________________________________________________________
application_load_balancer_forceignore_extra_php: true

# For remove previous installed PHP packages, use:
#   alb_extra_php_phpXX_enabled: true
#   alb_extra_php_phpXX_state: absent


## PHP 5.6
alb_extra_php_php56_enabled: false
alb_extra_php_php56_state: present
alb_extra_php_php56_packages:
  - php5.6-common
  - php5.6-fpm
  - php5.6-gd
  - php5.6-curl
  - php5.6-zip
  - php5.6-mysql
  - php5.6-imagick
  - php5.6-geoip
  - php5.6-intl
  - php5.6-mbstring

## PHP 7.0
alb_extra_php_php70_enabled: false
alb_extra_php_php70_state: present
alb_extra_php_php70_packages:
  - php7.0-common
  - php7.0-fpm
  - php7.0-gd
  - php7.0-curl
  - php7.0-zip
  - php7.0-mysql
  - php7.0-imagick
  - php7.0-geoip
  - php7.0-intl
  - php7.0-mbstring

## PHP 7.1
alb_extra_php_php71_enabled: false
alb_extra_php_php71_state: present
alb_extra_php_php71_packages:
  - php7.1-common
  - php7.1-fpm
  - php7.1-gd
  - php7.1-curl
  - php7.1-zip
  - php7.1-mysql
  - php7.1-imagick
  - php7.1-geoip
  - php7.1-intl
  - php7.1-mbstring

## PHP 7.2
alb_extra_php_php72_enabled: false
alb_extra_php_php72_state: present
alb_extra_php_php72_packages:
  - php7.2-common
  - php7.2-fpm
  - php7.2-gd
  - php7.2-curl
  - php7.2-zip
  - php7.2-mysql
  - php7.2-imagick
  - php7.2-geoip
  - php7.2-intl
  - php7.2-mbstring

# PHP 7.3
alb_extra_php_php73_enabled: false
alb_extra_php_php73_state: present
alb_extra_php_php73_packages:
  - php7.3-common
  - php7.3-fpm
  - php7.3-gd
  - php7.3-curl
  - php7.3-zip
  - php7.3-mysql
  - php7.3-imagick
  - php7.3-geoip
  - php7.3-intl
  - php7.3-mbstring

alb_extra_php_php74_enabled: false
alb_extra_php_php74_state: present
alb_extra_php_php74_packages:
  - php7.4-common
  - php7.4-fpm
  - php7.4-gd
  - php7.4-curl
  - php7.4-zip
  - php7.4-mysql
  - php7.4-imagick
  - php7.4-geoip
  - php7.4-intl
  - php7.4-mbstring

## Internal use / Placeholder tags _____________________________________________
application_load_balancer_openresty_httpport: 8080
application_load_balancer_openresty_httpsport: 4443
application_load_balancer_haproxy_httpport: 80
application_load_balancer_haproxy_httpsport: 443
application_load_balancer_haproxy_haproxy_template: "{{ role_path }}/files/haproxy-minimal.cfg.j2"

#
application_load_balancer_forceignore_haproxy: false
application_load_balancer_forceignore_openresty: false
application_load_balancer_forceignore_ufw: false
